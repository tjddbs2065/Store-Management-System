<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì§ì˜ì  ìƒì„¸ë³´ê¸°</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <style>
        body {
            background-color: #fafafa;
        }

        .page-wrap {
            max-width: 1500px;
            margin: 0 auto 40px auto;
            background: #fff;
            padding: 20px 30px;
            border-radius: 10px;
            border: 1px solid #ddd;
        }

        .field-block {
            border-radius: 6px;
            padding: 8px 0;
        }

        .field-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .field-label {
            width: 110px;
            font-weight: 600;
        }

        .field-value {
            flex: 1;
        }

        .field-value input.form-control-plaintext {
            padding: 4px 0;
        }

        .img-box img {
            max-height: 160px;
            max-width: 100%;
            object-fit: cover;
            border-radius: 6px;
            display: block;
        }

        .custom-btn {
            background-color: #FFEEAA !important;
            border-color: #FFEEAA !important;
            color: #000;
        }

        .custom-btn:hover {
            background-color: #f2da84 !important;
            border-color: #f2da84 !important;
        }

        .gray-btn {
            background-color: #D9D9D9 !important;
            border: #ffffff !important;
        }

        .gray-btn:hover {
            background-color: #C9C9C9 !important;
            border-color: #ffffff !important;
        }
    </style>
</head>

<body>

<!-- ğŸ”¹ ê³µí†µ ìƒë‹¨ íˆ´ë°” -->
<div th:replace="~{fragments/toolBar :: toolBar}"></div>

<!-- ëª©ë¡ ë³µê·€ìš© ë©”íƒ€ë°ì´í„° -->
<div id="storeDetailMeta"
     th:data-store-no="${store.storeNo}"
     th:data-from-tab="${fromTab}"
     th:data-from-page="${fromPage}"
     style="display:none;"></div>

<div class="page-wrap mt-4">
    <div class="d-flex justify-content-end mb-2">
        <button class="btn btn-outline-secondary" id="memberListBtn">ëª©ë¡</button>
    </div>

    <h3 class="fw-bold mb-4">
        ì§ì˜ì  ìƒì„¸ë³´ê¸°
        <span class="text-muted" th:text="${store.storeName}">ê°€ì‚°1í˜¸ì </span>
    </h3>

    <div class="border rounded p-4">

        <!-- ğŸ”¹ ì§ì˜ì  ì´ë¯¸ì§€ (í…ìŠ¤íŠ¸ ë ˆì´ë¸” ì—†ì´ ì¹´ë“œ ìƒë‹¨ ì™¼ìª½) -->
        <div class="img-box mb-3">
            <span th:if="${#strings.isEmpty(store.storeImage)}">ì´ë¯¸ì§€ ì—†ìŒ</span>
            <img th:if="${!#strings.isEmpty(store.storeImage)}"
                 th:src="${store.storeImage}"
                 src="https://picsum.photos/300/200"
                 alt="ì§ì˜ì  ì´ë¯¸ì§€">
        </div>

        <div class="row">
            <!-- ================= ì™¼ìª½ ì—´: ì§ì˜ì  ì •ë³´ ================= -->
            <div class="col-md-6">
                <div class="field-block">

                    <!-- ì§ì˜ì ëª… -->
                    <div class="field-row">
                        <div class="field-label">ì§ì˜ì ëª…</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.storeName}"
                                   value="ê°€ì‚°1í˜¸ì ">
                        </div>
                    </div>

                    <!-- ì§ì˜ì  ì£¼ì†Œ -->
                    <div class="field-row">
                        <div class="field-label">ì§ì˜ì  ì£¼ì†Œ</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.address}"
                                   value="ì„œìš¸íŠ¹ë³„ì‹œ ê¸ˆì²œêµ¬ ê°€ì‚°ë””ì§€í„¸1ë¡œ 128">
                        </div>
                    </div>

                    <!-- ì˜ì—…ìƒíƒœ -->
                    <div class="field-row">
                        <div class="field-label">ì˜ì—…ìƒíƒœ</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.storeStatus}"
                                   value="ì˜ì—…ì¤‘">
                        </div>
                    </div>

                    <!-- ê°œì  / íì  -->
                    <div class="field-row">
                        <div class="field-label">ê°œì /íì </div>
                        <div class="field-value">
                            <!-- openedDate: LocalDate â†’ yyyy-MM-dd í¬ë§· -->
                            <span th:text="${store.openedDate != null
                        ? #temporals.format(store.openedDate, 'yyyy-MM-dd')
                        : '-'}">2023-03-01</span>
                            &nbsp; ~ &nbsp;
                            <!-- íì—… ìƒíƒœì´ê³  closedDateê°€ ìˆì„ ë•Œë§Œ ë‚ ì§œ í‘œì‹œ -->
                            <span th:text="${store.storeStatus == 'íì—…' and store.closedDate != null
                        ? #temporals.format(store.closedDate, 'yyyy-MM-dd')
                        : '-'}">-</span>
                        </div>
                    </div>


                    <!-- ì˜ì—… ì‹œê°„ (AM/PM í‘œê¸°) -->
                    <div class="field-row">
                        <div class="field-label">ì˜ì—… ì‹œê°„</div>
                        <div class="field-value">
                            <span id="openTimeText" th:text="${store.openTime}">10:00</span>
                            &nbsp; ~ &nbsp;
                            <span id="closeTimeText" th:text="${store.closeTime}">22:00</span>
                        </div>
                    </div>

                </div>
            </div>

            <!-- ================= ì˜¤ë¥¸ìª½ ì—´: ì ì¥ / ì—°ë½ì²˜ ================= -->
            <div class="col-md-6">
                <div class="field-block">

                    <!-- ì ì¥ëª… -->
                    <div class="field-row">
                        <div class="field-label">ì ì¥ëª…</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.managerName}"
                                   value="í‘œìˆ˜ì •">
                        </div>
                    </div>

                    <!-- ì•„ì´ë”” -->
                    <div class="field-row">
                        <div class="field-label">ì•„ì´ë””</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.storeManagerId}"
                                   value="kosta123"
                                   id="managerId">
                        </div>
                    </div>

                    <!-- ì´ë©”ì¼ -->
                    <div class="field-row">
                        <div class="field-label">ì´ë©”ì¼</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.email}"
                                   value="kosta123@gmail.com">
                        </div>
                    </div>

                    <!-- ì ì¥ ì—°ë½ì²˜ -->
                    <div class="field-row">
                        <div class="field-label">ì ì¥ ì—°ë½ì²˜</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.phoneNumber}"
                                   value="010-9876-5432">
                        </div>
                    </div>

                    <!-- ì§ì˜ì  ì—°ë½ì²˜ -->
                    <div class="field-row">
                        <div class="field-label">ì§ì˜ì  ì—°ë½ì²˜</div>
                        <div class="field-value">
                            <input type="text" class="form-control-plaintext"
                                   readonly
                                   th:value="${store.storePhoneNumber}"
                                   value="02-000-0000">
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>

    <div class="text-center mt-4">
        <button class="btn custom-btn px-4" id="storeSetBtn">ìˆ˜ì •</button>
    </div>

    <!-- ì•Œë¦¼ ëª¨ë‹¬ -->
    <div class="modal fade" id="alertModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center border border-primary">
                <div class="modal-body">
                    <p id="alertMessage" class="fs-5 fw-bold mb-4 text-dark"></p>
                    <div class="d-flex justify-content-center gap-3">
                        <button type="button" class="btn px-4 custom-btn" data-bs-dismiss="modal">í™•ì¸</button>
                        <button type="button" class="btn btn-info px-4 gray-btn" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // HH:mm -> hh:mm AM/PM
    function toAmPm(timeStr) {
        if (!timeStr) return '';
        const parts = timeStr.split(':');
        let h = parseInt(parts[0], 10);
        if (isNaN(h)) return timeStr;
        const m = parts[1] || '00';

        const suffix = (h >= 12) ? 'PM' : 'AM';
        if (h === 0) h = 12;
        else if (h > 12) h -= 12;

        const hh = (h < 10 ? '0' : '') + h;
        return hh + ':' + m + ' ' + suffix;
    }


    $(function () {
        // ğŸ”¹ ì˜ì—… ì‹œê°„ AM/PM ë³€í™˜
        const openText = $('#openTimeText').text().trim();
        const closeText = $('#closeTimeText').text().trim();
        if (openText) $('#openTimeText').text(toAmPm(openText));
        if (closeText) $('#closeTimeText').text(toAmPm(closeText));

        // ğŸ”¹ ëª©ë¡ ë²„íŠ¼: ì§ì˜ì  íƒ­ + ê¸°ì¡´ í˜ì´ì§€ë¡œ ë³µê·€
        const $meta = $('#storeDetailMeta');
        const fromTab = $meta.data('from-tab') || 'store';
        const fromPage = $meta.data('from-page') || 1;

        $('#memberListBtn').on('click', function () {
            const params = new URLSearchParams();
            if (fromTab) params.set('tab', fromTab);
            if (fromPage) params.set('page', fromPage);
            const qs = params.toString();
            location.href = '/admin/memberListUI' + (qs ? '?' + qs : '');
        });

        // ìˆ˜ì • ê¸°ëŠ¥: ì¶”í›„ êµ¬í˜„ â†’ ì¼ë‹¨ alertë§Œ
        $('#storeSetBtn').on('click', function () {
            const managerId = $("#managerId").val();

            location.href = "/admin/storeSetUI/"+managerId;
        });

    });
</script>

</body>
</html>
