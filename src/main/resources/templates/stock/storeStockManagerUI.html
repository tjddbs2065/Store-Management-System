<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>재고 변동 조회 : 본사</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

    <style>
        /* ===== 페이지 스코프 ===== */
        .erp-stock-history{ --ctl-h:31px; --ctl-font:.95rem; --brand:#FFEEAA; --brand-hover:#f2da84; }
        .erp-stock-history body{ background:#f8f9fa; }
        .erp-stock-history .layout-container{ max-width:1500px; margin:0 auto; }

        /* 컨트롤 통일 */
        .erp-stock-history :where(.ctl .form-control, .ctl .form-select, .ctl .btn){ height:var(--ctl-h); font-size:var(--ctl-font); }
        .erp-stock-history :where(.input-group-sm > .form-control, .input-group-sm > .btn){ height:var(--ctl-h); }
        .erp-stock-history .w-compact{ max-width:220px; }
        .erp-stock-history .w-compact-lg{ max-width:320px; }
        .erp-stock-history .w-220{ width:220px; }
        @media (max-width:576px){ .erp-stock-history .w-220{ width:180px; } }

        /* 버튼 */
        .erp-stock-history .btn-main{ background:var(--brand); border-color:var(--brand); color:#000; }
        .erp-stock-history .btn-main:hover{ background:var(--brand-hover); border-color:var(--brand-hover); color:#000; }

        /* 테이블 */
        .erp-stock-history table.stock-table thead{ background:#e9ecef !important; }
        .erp-stock-history table.stock-table th{ color:#212529 !important; }
        .erp-stock-history table.stock-table td, .erp-stock-history table.stock-table th{ font-size:.9rem; }
        .erp-stock-history table.stock-table tbody tr{ background:#fff !important; }
        .erp-stock-history table.stock-table tbody tr:nth-of-type(odd),
        .erp-stock-history table.stock-table tbody tr:nth-of-type(even){ background:#fff !important; }

        /* + / - */
        .erp-stock-history td.text-end.chg-plus{ color:#0d6efd !important; font-weight:700; }
        .erp-stock-history td.text-end.chg-minus{ color:#dc3545 !important; font-weight:700; }

        /* 결과 카드 & 오버레이 */
        .erp-stock-history .result-card{ position:relative !important; }
        .erp-stock-history #storeNoticeOverlay{
            position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
            background:rgba(255,255,255,.6); backdrop-filter:blur(3px); z-index:5;
        }
        .erp-stock-history #storeNoticeOverlay .overlay-card{
            text-align:center; background:#ffffffdd; padding:28px 36px; border-radius:12px;
            box-shadow:0 4px 14px rgba(0,0,0,.12);
        }

        .erp-stock-history .pagination{ margin-top:16px; margin-bottom:0; }

        /* 모달 프리페치 가림막 */
        .erp-stock-history #storeSearchModal .modal-body._hideUntilReady{ visibility:hidden; }
    </style>
</head>
<body class="erp-stock-history" data-role="MANAGER">
<header th:replace="fragments/toolBar :: toolBar"></header>

<div class="layout-container py-4 px-3">
    <div class="d-flex align-items-center justify-content-between mb-3">
        <h3 class="fw-bold mb-0">재고 변동 조회 : 본사</h3>
        <div class="d-flex align-items-center gap-2 ctl">
            <span class="fw-semibold small">직영점</span>
            <input id="storeSearchKeyword" class="form-control form-control-sm w-220" placeholder="직영점명" />
            <button type="button" class="btn btn-sm btn-main px-3" id="btnOpenStoreSearch">검색</button>
        </div>
    </div>

    <!-- 조회영역 (2줄) -->
    <div class="card p-3 mb-3 shadow-sm border-0">
        <!-- 1줄: 기간 -->
        <div class="row g-2 align-items-end ctl mb-1">
            <div class="col-12 col-lg-6">
                <label class="fw-bold small d-block mb-1">기간</label>
                <div class="d-flex align-items-center gap-2">
                    <input type="date" id="dateFrom" class="form-control form-control-sm w-compact-lg" />
                    <span class="small">~</span>
                    <input type="date" id="dateTo" class="form-control form-control-sm w-compact-lg" />
                </div>
            </div>
            <div class="col d-none d-lg-block"></div>
        </div>

        <!-- 2줄: 카테고리/변동유형/조건/검색어 + 조회/초기화(오른쪽) -->
        <div class="row g-2 align-items-end ctl">
            <div class="col-6 col-md-2">
                <label class="fw-bold small d-block mb-1">카테고리</label>
                <select id="categorySelect" class="form-select form-select-sm">
                    <option value="">전체</option><option>도우</option><option>소스</option>
                    <option>치즈</option><option>육류</option><option>야채</option>
                    <option>사이드</option><option>음료</option>
                </select>
            </div>
            <div class="col-6 col-md-2">
                <label class="fw-bold small d-block mb-1">변동유형</label>
                <select id="reasonSelect" class="form-select form-select-sm">
                    <option value="">전체</option>
                    <option value="입고">입고</option><option value="판매">판매</option>
                    <option value="폐기">폐기</option><option value="조정">조정</option>
                </select>
            </div>
            <div class="col-6 col-md-2">
                <label class="fw-bold small d-block mb-1">조건</label>
                <select id="searchTypeSelect" class="form-select form-select-sm">
                    <option value="ITEM_NAME">품목명</option>
                    <option value="ITEM_CODE">품목코드</option>
                </select>
            </div>
            <div class="col-6 col-md-3">
                <label class="fw-bold small d-block mb-1">검색어</label>
                <input id="searchKeyword" class="form-control form-control-sm w-100" placeholder="검색어 입력" />
            </div>
            <div class="col-12 col-md-3">
                <div class="d-flex gap-2 justify-content-md-end mt-2 mt-md-0">
                    <button class="btn btn-sm btn-main px-3" id="btnSearch">조회</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary px-3" id="btnReset">초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 결과 -->
    <div class="card shadow-sm border-0 result-card">
        <div id="storeNoticeOverlay">
            <div class="overlay-card">
                <i class="bi bi-shop fs-1 mb-2"></i>
                <div class="fw-bold">먼저 직영점을 선택해주세요</div>
                <div class="text-muted small">변동 내역은 직영점 선택 후 확인할 수 있어요.</div>
            </div>
        </div>

        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table align-middle mb-0 stock-table bg-white">
                    <thead>
                    <tr class="table-light">
                        <th>변동일시</th>
                        <th>카테고리</th>
                        <th>품목코드</th>
                        <th>품목명</th>
                        <th>변동유형</th>
                        <th class="text-end">변동수량</th>
                        <th class="text-end">현재 재고</th>
                        <th>폐기사유</th>
                    </tr>
                    </thead>
                    <tbody id="stockHistoryBody">
                    <!-- 데이터 바인딩 or 샘플 -->
                    <tr><td>2025-11-20 10:12</td><td>도우</td><td>DOUGH-M-230G</td><td>도우 M 230g(레귤러)</td><td>입고</td><td class="text-end">+50 ea</td><td class="text-end">120 ea</td><td>-</td></tr>
                    <tr><td>2025-11-20 18:40</td><td>도우</td><td>DOUGH-M-230G</td><td>도우 M 230g(레귤러)</td><td>판매</td><td class="text-end">-24 ea</td><td class="text-end">96 ea</td><td>-</td></tr>
                    <tr><td>2025-11-19 09:30</td><td>소스</td><td>SAUCE-3KG-CAN</td><td>토마토 소스 3kg 캔</td><td>입고</td><td class="text-end">+5 can</td><td class="text-end">18 can</td><td>-</td></tr>
                    <tr><td>2025-11-19 21:05</td><td>소스</td><td>SAUCE-3KG-CAN</td><td>토마토 소스 3kg 캔</td><td>폐기</td><td class="text-end">-1 can</td><td class="text-end">17 can</td><td>유통기한 경과</td></tr>
                    </tbody>
                </table>
            </div>

            <nav class="mt-3 mb-3">
                <ul class="pagination justify-content-center" id="pager"></ul>
            </nav>
        </div>
    </div>
</div>

<!-- 모달 프래그먼트 -->
<div th:replace="fragments/modalStoreSearch :: modalStoreSearch"></div>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/modalStoreSearch.js"></script>
<script src="/js/storeStock.js"></script>
<script src="/js/modalStoreSearch.js"


</body>
</html>
